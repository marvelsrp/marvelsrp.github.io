<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>REMOTE STRAPI CREATE NEW USER</title>
</head>
<body>
<script>
    const cmsToken = "0ace0b3aec025a579c1b26be20a59f376acd684e46fd7c1ec3f2b0319e80576a439d95798554bee859be16ba496a340b6e168319e3c914fd8e9ab0dce0d445cb77e60324fe668ea25aaa641145b647f07490e51d9996aba61186e4aa1dca3983183202faf2dc0be33e5aa5f47c4a774d2c67821cf3e8bdfb877ac9ab3b22d407";
    const email = "SUPERADMIN_zero_0x00@standoff365.com";
    const password = 'As#12$DS!A3';
    const firstname = 'SUPER_ADMIN';
    const lastname = firstname;
    const ROLE_SUPER_ADMIN = 1;
    const HOST = 'strapi-app:1337';

    (async () => {
        const res = await fetch(`http://${HOST}/admin/users`, {
            "headers": {
                "authorization": `Bearer ${cmsToken}`,
                "content-type": "application/json",
            },

            "body": JSON.stringify({
                "firstname": firstname,
                "lastname": lastname,
                "email": email,
                "roles": [ROLE_SUPER_ADMIN]
            }),
            "method": "POST",
            "mode": "cors",
            "credentials": "include"
        }).then(res => res.json());
        const registrationToken = res.data.registrationToken;
        alert(`Create invite for ${email} = `+registrationToken);
        const regUserResponse = await fetch(`http://${HOST}/admin/register`, {
            "headers": {
                "authorization": `Bearer ${cmsToken}`,
                "content-type": "application/json",
            },
            "body": JSON.stringify({
                "userInfo":{
                    "firstname": firstname,
                    "lastname": lastname,
                    "password": password
                },
                "registrationToken": registrationToken
            }),
            "method": "POST",
            "mode": "cors",
            "credentials": "include"
        }).then(res => res.json());
        alert(`Confirm invite user for ${email} with password: ${password}. List of all users in console =)`);
        console.log('All users:'+ regUserResponse.data.results)
    })()
</script>
</body>
</html>