<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>LOCAL STRAPI CREATE USER</title>
    <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-TTL8PND');</script>
    <!-- End Google Tag Manager -->
</head>
<body>
<script>
    const cmsToken = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiaWF0IjoxNjc3MzI3NTQ5LCJleHAiOjE2Nzk5MTk1NDl9.8dNvIl0hGMjTNpn-laUSP4n3DesLmkqdQYjIXQy7kG4';
    const email = "SUPERADMIN_zero_0x00@standoff365.com";
    const password = 'As#12$DS!A3';
    const firstname = 'SUPER_ADMIN';
    const lastname = firstname;
    const ROLE_SUPER_ADMIN = 1;
    const HOST = 'localhost:1337';

    (async () => {
        const res = await fetch(`http://${HOST}/admin/users`, {
            "headers": {
                "authorization": `Bearer ${cmsToken}`,
                "content-type": "application/json",
            },

            "body": JSON.stringify({
                "firstname": firstname,
                "lastname": lastname,
                "email": email,
                "roles": [ROLE_SUPER_ADMIN]
            }),
            "method": "POST",
            "mode": "cors",
            "credentials": "include"
        }).then(res => res.json());
        const registrationToken = res.data.registrationToken;
        const regUserResponse = await fetch(`http://${HOST}/admin/register`, {
            "headers": {
                "authorization": `Bearer ${cmsToken}`,
                "content-type": "application/json",
            },
            "body": JSON.stringify({
                "userInfo":{
                    "firstname": firstname,
                    "lastname": lastname,
                    "password": password
                },
                "registrationToken": registrationToken
            }),
            "method": "POST",
            "mode": "cors",
            "credentials": "include"
        }).then(res => res.json());
        console.log('All users:'+ regUserResponse.data.results)
    })()
</script>

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-TTL8PND"
                  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
</body>
</html>